---
import { MenuIcon } from "astro-navbar";
interface Props {
  lang: "en" | "es";
}

const { lang } = Astro.props;

const menuitems = [
  {
    title: "Home",
    path: "#",
  },
  {
    title: "Projects",
    path: "#",
  },
  {
    title: "Contact",
    path: "#",
  },
];
---

<div class="top-0 w-full sticky px-0">
  <nav class="flex items-center py-2 gap-8 bg-white justify-between">
    <a href="/" class="font-sans font-bold text-xl">PABLO VILLARROEL</a>
    <ul class="md:flex gap-12 hidden">
      {
        menuitems.map((item) => (
          <li class="cursor-pointer text-lg font-bold py-2">
            {item.title.toUpperCase()}
          </li>
        ))
      }
      <select class="bg-white">
        <option value="en" selected={lang === "en"}>EN ðŸ‡ºðŸ‡¸</option>
        <option value="es" selected={lang === "es"}>ES ðŸ‡¨ðŸ‡±</option>
      </select>
    </ul>
    <div id="menu-button" class="md:hidden">
      <MenuIcon />
    </div>
  </nav>
  <div id="dropdown" class="bg-white hidden w-full">
    <ul class="pb-4 flex flex-col gap-3">
      {
        menuitems.map((item) => (
          <li class="text-lg font-bold py-2">{item.title.toUpperCase()}</li>
        ))
      }
      <select>
        <option value="en" selected={lang === "en"}>EN ðŸ‡ºðŸ‡¸</option>
        <option value="es" selected={lang === "es"}>ES ðŸ‡¨ðŸ‡±</option>
      </select>
    </ul>
  </div>
</div>

<script>
  function handleClick() {
    const dropdown = document.getElementById("dropdown");
    dropdown?.classList.toggle("hidden");
  }

  document
    .getElementById("menu-button")
    ?.addEventListener("click", handleClick);

  function scrollToElement(element: string) {
    const el = document.getElementById(element.trim());
    el?.scrollIntoView({ behavior: "smooth" });
  }

  const menuItems = document.querySelectorAll("li");
  menuItems.forEach((item) => {
    item.addEventListener("click", () => {
      const element = item.textContent?.toLowerCase();
      scrollToElement(element!);
    });
  });

  const selects = document.querySelectorAll("select");
  selects.forEach((select) => {
    select?.addEventListener("change", (e) => {
      const lang = (e.target as HTMLSelectElement).value;
      window.location.replace(`/${lang}`);
    });
  });
</script>
